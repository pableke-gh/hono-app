<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:p="http://primefaces.org/ui" 
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:c="http://java.sun.com/jsp/jstl/core">

	<h2><h:outputText value="#{msg['uae.irse.index.msg.list']}" escape="false" /></h2>
	<h:form id="xeco-filter" prependId="false" onsubmit="loading();">
		<div class="ui-blocks">
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.ejercicio']}" escape="false" />:</div>
				<h:selectOneMenu value="#{iris.list.ejercicio}" styleClass="ui-input ui-select ui-filter" tabindex="1" title="#{msg['tit.ejercicio']}">
					<f:selectItems value="#{iris.list.ejercicios}" />
				</h:selectOneMenu>
			</label>
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.estado']}" escape="false" />:</div>
				<h:selectOneMenu id="estado" value="#{iris.list.estado}" styleClass="ui-input ui-select ui-filter" tabindex="2" title="#{msg['tit.estado']}">
					<f:selectItem itemValue="" itemLabel="" />
					<f:selectItem itemValue="6" itemLabel="#{msg['uae.irse.filter.estado.6']}" itemEscaped="false"/>
					<f:selectItem itemValue="5" itemLabel="#{msg['uae.irse.filter.estado.5']}" itemEscaped="false"/>
					<f:selectItem itemValue="1" itemLabel="#{msg['uae.irse.filter.estado.1']}" itemEscaped="false"/>
					<f:selectItem itemValue="2" itemLabel="#{msg['uae.irse.filter.estado.2']}" itemEscaped="false"/>
					<f:selectItem itemValue="4" itemLabel="#{msg['uae.irse.filter.estado.4']}" itemEscaped="false"/>
					<f:selectItem itemValue="7" itemLabel="#{msg['uae.irse.filter.estado.7']}" itemEscaped="false"/>
					<f:selectItem itemValue="8" itemLabel="#{msg['uae.irse.filter.estado.8']}" itemEscaped="false"/>
				</h:selectOneMenu>
			</label>
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.mi.firma']}" escape="false" />:</div>
				<h:selectOneMenu id="fMiFirma" value="#{iris.list.firma}" styleClass="ui-input ui-select ui-filter" tabindex="3" title="#{msg['lbl.mi.firma']}">
					<f:selectItem itemValue="" itemLabel="" />
					<f:selectItem itemValue="5" itemLabel="#{irse.getMsg('lblPendiente')}" />
					<f:selectItem itemValue="1" itemLabel="#{irse.getMsg('lblAceptada')}" />
					<f:selectItem itemValue="2" itemLabel="#{irse.getMsg('lblRechazada')}" />
				</h:selectOneMenu>
			</label>
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.codigo']}" escape="false" />:</div>
				<h:inputText value="#{iris.list.codigo}" styleClass="ui-input ui-code ui-filter" tabindex="4" />
			</label>
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.presupuesto']}" escape="false" />:</div>
				<h:inputText value="#{iris.list.organica}" styleClass="ui-input ui-code ui-filter" tabindex="5" />
			</label>
			<label class="ui-block">
				<div class="label"><h:outputText value="#{msg['lbl.fecha.creacion']}" escape="false" />:</div>
				<h:inputText id="f-min" value="#{iris.list.FMin}" tabindex="6" styleClass="ui-input ui-date ui-filter"/> ...
				<h:inputText id="f-max" value="#{iris.list.FMax}" tabindex="7" styleClass="ui-input ui-date ui-filter"/>
			</label>
		</div>

		<div class="ui-blocks">
			<div class="ui-block-row">
				<a id="filtro" href="#tab-toggle" data-toggle="fa-angle-double-down fa-angle-double-up"><h:outputText value="#{msg['uae.irse.filter.lbl.extra']}" escape="false" /><i class="fas fa-angle-double-down icon"></i></a>
			</div>
			<label class="ui-block info-filtro hide">
				<div class="label"><h:outputText value="#{msg['uae.irse.tab0.lbl.int']}" escape="false" />:</div>
				<h:inputText value="#{iris.list.interesado}" styleClass="ui-input ui-text ui-filter" tabindex="8" />
			</label>
			<label class="ui-block info-filtro hide">
				<div class="label"><h:outputText value="#{msg['uae.irse.tab0.lbl.act.a']}" escape="false" /></div>
				<h:selectOneMenu id="filtro-actividad" value="#{iris.list.actividad}" class="ui-input ui-select ui-filter" tabindex="10">
					<f:selectItem itemValue="" itemLabel="" />
					<f:selectItem itemValue="COM" itemLabel="#{msg['uae.irse.tab0.act.com']}" itemEscaped="false"/>
					<f:selectItem itemValue="MUN" itemLabel="#{msg['uae.irse.tab0.act.mun']}" itemEscaped="false"/>
					<f:selectItem itemValue="MES" itemLabel="#{msg['uae.irse.tab0.act.mes']}" itemEscaped="false"/>
					<f:selectItem itemValue="IAE" itemLabel="#{msg['uae.irse.tab0.act.iae']}" itemEscaped="false"/>
					<f:selectItem itemValue="ATR" itemLabel="#{msg['uae.irse.tab0.act.atr']}" itemEscaped="false"/>
					<f:selectItem itemValue="IAE+ATR" itemLabel="#{msg['uae.irse.tab0.act.iae.atr']}" itemEscaped="false"/>
					<f:selectItem itemValue="AFO" itemLabel="#{msg['uae.irse.tab0.act.afo']}" itemEscaped="false"/>
					<f:selectItem itemValue="IAE+AFO" itemLabel="#{msg['uae.irse.tab0.act.iae.afo']}" itemEscaped="false"/>
					<f:selectItem itemValue="ACS" itemLabel="#{msg['uae.irse.tab0.act.acs']}" itemEscaped="false"/>
					<f:selectItem itemValue="OCE" itemLabel="#{msg['uae.irse.tab0.act.col']}" itemEscaped="false"/>
					<f:selectItem itemValue="IAE+OCE" itemLabel="#{msg['uae.irse.tab0.act.iae.col']}" itemEscaped="false"/>
					<f:selectItem itemValue="A7J" itemLabel="#{msg['uae.irse.tab0.act.a7j']}" itemEscaped="false"/>
					<f:selectItem itemValue="MOV" itemLabel="#{msg['uae.irse.tab0.act.mov']}" itemEscaped="false"/>
				</h:selectOneMenu>
			</label>
			<label class="ui-block info-filtro hide">
				<div class="label"><h:outputText value="#{msg['uae.irse.tab0.lbl.tramite']}" escape="false" /></div>
				<h:selectOneMenu id="filtro-tramite" value="#{iris.list.tramite}" class="ui-input ui-select ui-filter" tabindex="11">
					<f:selectItem itemValue="" itemLabel="" />
					<f:selectItem itemValue="AUT" itemLabel="#{msg['uae.irse.tab0.tramit.aut']}" itemEscaped="false"/>
					<f:selectItem itemValue="LIQ" itemLabel="#{msg['uae.irse.tab0.tramit.liq']}" itemEscaped="false"/>
					<f:selectItem itemValue="AyL" itemLabel="#{msg['uae.irse.tab0.tramit.ayl']}" itemEscaped="false"/>
				</h:selectOneMenu>
			</label>
		</div>

		<div class="navbar">
			<a href="#tab-prev" class="btn btn-info" title="#{msg['tit.btn.volver.ini']}" tabindex="12">
				<i class="fas fa-caret-left btn-icon-left"></i><h:outputText value="#{msg['lbl.btn.volver']}" escape="false" /></a>
			<a href="#tab-action-list" class="btn btn-info" tabindex="13"><i class="far fa-search btn-icon-left"></i>Buscar</a>
			<c:if test="#{not iris.user.otri}">
				<a href="#tab-action-list-all" class="btn btn-info" tabindex="13"><i class="far fa-search btn-icon-left"></i>Buscar</a> 
			</c:if>
			<a href="#tab-action-relist" class="btn btn-warn" tabindex="14"><i class="far fa-times-circle btn-icon-left"></i>Limpiar</a>
			<p:remoteCommand name="rcList" action="#{iris.list.list()}" oncomplete="loadFiltro(xhr, status, args)" />
		</div>

		<table id="solicitudes" class="tb-xeco">
			<thead>
				<tr>
					<th class="slim"></th>
					<th><h:outputText value="#{msg['lbl.codigo']}" escape="false" /></th>
					<th><h:outputText value="#{msg['lbl.estado']}" escape="false" /></th>
					<th><h:outputText value="#{msg['lbl.mi.firma']}" escape="false" /></th>
					<th><span class="hide-sm"><h:outputText value="#{msg['lbl.sig.firma']}" escape="false" /></span></th>
					<th class="hide-xs"><h:outputText value="#{msg['lbl.fecha.creacion']}" escape="false" /></th>
					<th><h:outputText value="#{msg['lbl.presupuesto']}" escape="false" /></th>
					<th><h:outputText value="#{msg['uae.irse.tab0.lbl.int']}" escape="false" /></th>
					<th><span class="hide-sm"><h:outputText value="#{msg['lbl.objeto.act']}" escape="false" /></span></th>
					<th><h:outputText value="#{msg['lbl.imp.liq']}" escape="false" /></th>
					<th class="no-print"><h:outputText value="#{msg['lbl.acciones']}" escape="false" /></th>
				</tr>
			</thead>
			<tbody>
				<!--<tr class="tb-data">
					<td class="text-right no-print">
						<p:commandLink action="#{iris.view(sol)}" onclick="if (isCached('#{sol.idIrse}', '#{irse.form.getPaso(sol)}'))return false;loading();" oncomplete="viewIrse(xhr, status, args)" title="Acceso a la comunicación">
								<i class="fas fa-search action text-blue resize"></i></p:commandLink>
						<c:if test="#{sol.editable and iris.user.uae}">
							<p:commandLink action="#{irse.list.activePaso8(sol)}" onclick="loading();" oncomplete="showAlerts(xhr, status, args)" 
								title="Activar Otras Indemnizaciones Extraordinarias (paso 8)"><i class="fas fa-plus action text-green resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{irse.isReactivable(sol)}">
							<p:commandLink action="#{irse.list.clone(sol)}" onclick="if (!fnClone()) return false;" oncomplete="viewIrse(xhr, status, args, 'form')"
									title="Subsanar la comunicación salvo cambio de presupuesto">
								<i class="far fa-edit action text-blue resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{sol.firmable}">
							<p:commandLink action="#{irse.list.firmar(sol)}" onclick="if (!fnFirmar()) return false;loading();" oncomplete="showAlerts(xhr, status, args)" title="Firmar rolicitud"><i class="fas fa-check action text-green resize"></i></p:commandLink>
							<p:commandLink action="#{irse.list.confirm(sol)}" onclick="loading();" oncomplete="viewIrse(xhr, status, args, 'reject');" title="Ir al motivo de rechazo"><i class="fas fa-times action text-red resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{sol.pendiente or sol.ejecutable}">
							<p:commandLink action="#{irse.list.report(sol)}" onclick="loading();" oncomplete="handleReport(xhr, status, args)" title="#{msg['tit.btn.informe']}">
								<i class="fal fa-file-pdf action text-red resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{iris.user.admin and irse.isIntegrable(sol)}">
							<p:commandLink action="#{irse.list.rptFinalizar(sol)}" onclick="loading();" oncomplete="openHtml(xhr, status, args, 'Informe IRIS')" title="Consulta los datos de la solicitud"><i class="fas fa-clipboard-list action text-blue resize"></i></p:commandLink>
							<p:commandLink action="#{irse.list.integrar(sol)}" onclick="if(!fnIntegrar(this)) return false;" oncomplete="showAlerts(xhr, status, args)" title="Lanza el proceso de integración con la capa SOA"><i class="far fa-save action resize text-blue"></i></p:commandLink>
						</c:if>
						<c:if test="#{irse.isEjecutable(sol) and (irse.isUae() or sol.isFirmaGestor())}">
							<p:commandLink action="#{irse.list.uxxi(sol)}" onclick="loading();" oncomplete="viewIrse(xhr, status, args, 'uxxiec');" title="Expediente asociado a la solicitud"><i class="fal fa-cog action text-blue resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{iris.user.admin}">
							<p:commandLink action="#{irse.list.emails(sol)}" onclick="loading();" oncomplete="showAlerts(xhr, status, args)" title="Envia una prueba de cada tipo de correo al administrador"><i class="fal fa-mail-bulk action text-blue resize"></i></p:commandLink>
							<p:commandLink action="#{irse.list.recalc(sol)}" onclick="if (!fnFirmar()) return false;loading();" oncomplete="showAlerts(xhr, status, args)" title="Recalcula las firmas asociadas a la comunicación"><i class="far fa-file-signature action text-green resize"></i></p:commandLink>
						</c:if>
						<c:if test="#{irse.form.isRemovable(sol)}">
							<p:commandLink action="#{irse.list.remove(sol.idIrse)}" onclick="if (!fnRemove()) return false;" oncomplete="showAlerts(xhr, status, args)" title="Borra la comunicación del sistema"><i class="fal fa-trash-alt action text-red resize"></i></p:commandLink>
						</c:if>
					</td>
				</tr>-->
			</tbody>
			<tfoot></tfoot>
		</table>
	
		<p:remoteCommand name="rcView" action="#{iris.view()}" oncomplete="viewIrse(xhr, status, args)" />
		<p:remoteCommand name="rcFirmar" action="#{iris.firmas.firmar()}" oncomplete="loadFirmas(xhr, status, args)" />
		<p:remoteCommand name="rcReject" action="#{iris.firmas.reject()}" oncomplete="updateIrse(xhr, status, args, 'reject')" />
		<p:remoteCommand name="rcReport" action="#{iris.list.report()}" oncomplete="handleReport(xhr, status, args)" />
		<p:remoteCommand name="rcIntegrar" action="#{iris.ws()}" oncomplete="showAlerts(xhr, status, args)" />
		<p:remoteCommand name="rcUxxiec" action="#{iris.uxxiec.view()}" oncomplete="loadUxxiec(xhr, status, args)" />
		<p:remoteCommand name="rcEmails" action="#{iris.emails()}" oncomplete="showAlerts(xhr, status, args)" />
		<p:remoteCommand name="rcRemove" action="#{iris.remove()}" oncomplete="showTab(xhr, status, args, 'list')" />
	</h:form>

	<a href="#tab-prev" class="btn btn-info" title="#{msg['tit.btn.volver.ini']}">
		<i class="fas fa-caret-left btn-icon-left"></i><h:outputText value="#{msg['lbl.btn.volver']}" escape="false" /></a>
</html>
